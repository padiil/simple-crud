<%- include('partials/header') %>
<main>
  <div class="bg-white shadow rounded p-4">
    <h2 class="text-xl font-semibold mb-4">Items</h2>
    <% if (items.length === 0) { %>
      <p class="text-gray-500">No items yet. Create one!</p>
    <% } else { %>
      <ul class="space-y-3">
        <% items.forEach(item => { %>
          <li class="border rounded p-3 flex items-start justify-between">
            <div>
              <div class="flex items-center gap-2">
                <form method="POST" action="/items/<%= item._id %>?_method=PUT">
                  <input type="hidden" name="title" value="<%= item.title %>" />
                  <input type="hidden" name="description" value="<%= item.description || '' %>" />
                  <input type="checkbox" name="done" onchange="this.form.submit()" <%= item.done ? 'checked' : '' %> />
                </form>
                <span class="font-medium <%= item.done ? 'line-through text-gray-500' : '' %>"><%= item.title %></span>
              </div>
              <% if (item.description) { %>
                <p class="text-gray-600 text-sm mt-1"><%= item.description %></p>
              <% } %>
            </div>
            <div class="flex items-center gap-2">
              <a href="/items/<%= item._id %>/edit" class="px-2 py-1 text-sm bg-yellow-500 text-white rounded hover:bg-yellow-600">Edit</a>
              <form method="POST" action="/items/<%= item._id %>?_method=DELETE" onsubmit="return confirm('Delete this item?')">
                <button class="px-2 py-1 text-sm bg-red-600 text-white rounded hover:bg-red-700">Delete</button>
              </form>
            </div>
          </li>
        <% }) %>
      </ul>
    <% } %>
  </div>
</main>
<%- include('partials/footer') %>
